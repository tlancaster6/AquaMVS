---
phase: 04-documentation-and-examples
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - README.md
  - docs/api/index.rst
  - docs/api/pipeline.rst
  - docs/api/config.rst
  - docs/api/calibration.rst
  - docs/api/reconstruction.rst
  - docs/api/cli.rst
autonomous: true

must_haves:
  truths:
    - "README leads with hero image placeholder and project description before installation"
    - "README has standard badge set (PyPI, Python versions, CI, license)"
    - "README has minimal quickstart snippet linking to full docs"
    - "API reference pages document public API and extension points"
  artifacts:
    - path: "README.md"
      provides: "Visual-first README with badges, hero image, quickstart"
      contains: "![AquaMVS"
    - path: "docs/api/index.rst"
      provides: "API reference landing page"
    - path: "docs/api/pipeline.rst"
      provides: "Pipeline class and PipelineContext autodoc"
      contains: "autoclass:: aquamvs.Pipeline"
    - path: "docs/api/config.rst"
      provides: "Config model autodoc"
      contains: "autoclass:: aquamvs.PipelineConfig"
  key_links:
    - from: "README.md"
      to: "docs/installation.rst"
      via: "link to full installation docs"
      pattern: "INSTALL.md|installation"
    - from: "docs/api/pipeline.rst"
      to: "src/aquamvs/pipeline/runner.py"
      via: "autodoc extracts docstrings"
      pattern: "autoclass.*Pipeline"
---

<objective>
Create visual-first README and API reference documentation pages.

Purpose: README is the project's front door — make it compelling for new users. API reference gives developers autodoc-generated documentation of the public interface and extension points (Pipeline, config models, CLI, protocols).

Output: Complete README.md, API reference RST files with autodoc directives.
</objective>

<execution_context>
@C:/Users/tucke/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/tucke/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@README.md
@src/aquamvs/__init__.py
@src/aquamvs/pipeline/__init__.py
@src/aquamvs/config.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rewrite README with visual-first layout</name>
  <files>README.md</files>
  <action>
Rewrite README.md with this structure (per user decisions: visual-first, hero image lead, badges, minimal quickstart):

1. **Hero image**: Add placeholder image reference at top:
   ```markdown
   ![AquaMVS reconstruction](docs/_static/hero.png)
   ```
   (Image will be generated in Plan 05 from example dataset. Use alt text describing what it shows.)

2. **Badges** (immediately after hero image):
   - PyPI version: `[![PyPI](https://img.shields.io/pypi/v/aquamvs)](https://pypi.org/project/aquamvs/)`
   - Python versions: `[![Python](https://img.shields.io/pypi/pyversions/aquamvs)](https://pypi.org/project/aquamvs/)`
   - CI status: `[![CI](https://github.com/tlancaster6/AquaMVS/actions/workflows/test.yml/badge.svg)](https://github.com/tlancaster6/AquaMVS/actions/workflows/test.yml)`
   - License: `[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](https://opensource.org/licenses/MIT)`

3. **Title + tagline**: "# AquaMVS" followed by one-sentence description: "Multi-view stereo reconstruction of underwater surfaces viewed through a flat water surface, with Snell's law refraction modeling."

4. **What it does** section (2-3 sentences): Companion to AquaCal. Consumes calibration output + synchronized video. Produces time-series 3D surface reconstructions. Mention key capabilities: sparse/dense matching, plane sweep stereo, depth fusion, surface meshing.

5. **Key Features** bullet list:
   - Refractive ray casting through air-water interface (Snell's law)
   - Dual matching pathways: LightGlue (sparse) and RoMa v2 (dense)
   - Multi-view depth fusion with geometric consistency filtering
   - Surface reconstruction (Poisson, heightfield, BPA)
   - Mesh export (PLY, OBJ, STL, GLTF) with simplification
   - Full CLI and Python API

6. **Quick Start** section (minimal, per user decision):
   ```python
   from aquamvs import Pipeline

   pipeline = Pipeline("config.yaml")
   pipeline.run()
   ```
   Link to full documentation for details.

7. **Installation** section: Keep very brief — just the 3-step summary already there, link to INSTALL.md and full docs.

8. **Documentation** section: Link to ReadTheDocs (https://aquamvs.readthedocs.io/) once hosted. For now use placeholder URL.

9. **Citation** section: Placeholder for Zenodo DOI (pending todo from STATE.md).

10. **License**: MIT

Remove any content from old README that doesn't fit this structure. Keep it concise — full docs are in Sphinx.
  </action>
  <verify>Read README.md, confirm: hero image reference exists, 4 badges present, quickstart Python snippet present, links to INSTALL.md and docs present.</verify>
  <done>README is visual-first with hero image placeholder, badges, concise quickstart, and links to full documentation</done>
</task>

<task type="auto">
  <name>Task 2: Create API reference pages with autodoc</name>
  <files>docs/api/index.rst, docs/api/pipeline.rst, docs/api/config.rst, docs/api/calibration.rst, docs/api/reconstruction.rst, docs/api/cli.rst</files>
  <action>
Create `docs/api/` directory with autodoc-driven API reference. Per user decision, scope is: public API + extension points (Pipeline class, config models, CLI, protocols like FrameSource and CalibrationProvider). Internal stage modules stay undocumented.

1. `docs/api/index.rst`:
   ```rst
   API Reference
   =============

   .. toctree::
      :maxdepth: 2

      pipeline
      config
      calibration
      reconstruction
      cli
   ```

2. `docs/api/pipeline.rst` — Pipeline and orchestration:
   ```rst
   Pipeline
   ========

   .. autoclass:: aquamvs.Pipeline
      :members:
      :undoc-members:

   .. autoclass:: aquamvs.PipelineContext
      :members:

   .. autofunction:: aquamvs.run_pipeline

   .. autofunction:: aquamvs.process_frame

   Protocols
   ---------

   .. autoclass:: aquamvs.pipeline.interfaces.FrameSource
      :members:

   .. autoclass:: aquamvs.pipeline.interfaces.CalibrationProvider
      :members:
   ```

3. `docs/api/config.rst` — Configuration models:
   ```rst
   Configuration
   =============

   .. autoclass:: aquamvs.PipelineConfig
      :members:
      :undoc-members:

   .. autoclass:: aquamvs.SparseMatchingConfig
      :members:

   .. autoclass:: aquamvs.DenseMatchingConfig
      :members:

   .. autoclass:: aquamvs.ReconstructionConfig
      :members:

   .. autoclass:: aquamvs.RuntimeConfig
      :members:

   .. autoclass:: aquamvs.PreprocessingConfig
      :members:
   ```
   Include all config classes from `__all__` that are Pydantic models.

4. `docs/api/calibration.rst` — Calibration and projection:
   ```rst
   Calibration
   ===========

   .. autoclass:: aquamvs.CalibrationData
      :members:

   .. autoclass:: aquamvs.CameraData
      :members:

   .. autofunction:: aquamvs.load_calibration_data

   .. autofunction:: aquamvs.compute_undistortion_maps
   ```

5. `docs/api/reconstruction.rst` — Triangulation, fusion, surface:
   ```rst
   Reconstruction
   ==============

   Triangulation
   -------------

   .. autofunction:: aquamvs.triangulate_pair
   .. autofunction:: aquamvs.triangulate_all_pairs
   .. autofunction:: aquamvs.triangulate_rays
   .. autofunction:: aquamvs.filter_sparse_cloud
   .. autofunction:: aquamvs.compute_depth_ranges

   Depth Fusion
   ------------

   .. autofunction:: aquamvs.filter_depth_map
   .. autofunction:: aquamvs.fuse_depth_maps
   .. autofunction:: aquamvs.backproject_depth_map

   Surface Reconstruction
   ----------------------

   .. autofunction:: aquamvs.reconstruct_surface
   .. autofunction:: aquamvs.reconstruct_poisson
   .. autofunction:: aquamvs.reconstruct_heightfield
   .. autofunction:: aquamvs.reconstruct_bpa
   .. autofunction:: aquamvs.export_mesh
   .. autofunction:: aquamvs.simplify_mesh
   ```

6. `docs/api/cli.rst` — CLI reference:
   ```rst
   Command-Line Interface
   ======================

   AquaMVS provides a command-line interface for common operations.

   .. code-block:: bash

      aquamvs --help

   Commands
   --------

   ``aquamvs init``
   ~~~~~~~~~~~~~~~~
   Generate a pipeline configuration from a video directory and calibration file.

   .. code-block:: bash

      aquamvs init --video-dir /path/to/videos --pattern "^([a-z0-9]+)-" \
                   --calibration /path/to/calibration.json \
                   --output-dir /path/to/output

   ``aquamvs run``
   ~~~~~~~~~~~~~~~
   Run the reconstruction pipeline.

   .. code-block:: bash

      aquamvs run config.yaml

   ``aquamvs export-refs``
   ~~~~~~~~~~~~~~~~~~~~~~
   Export undistorted reference images for ROI mask creation.

   .. code-block:: bash

      aquamvs export-refs config.yaml --frame 0

   ``aquamvs benchmark``
   ~~~~~~~~~~~~~~~~~~~~
   Run benchmark comparison across extractor configurations.

   .. code-block:: bash

      aquamvs benchmark config.yaml --frame 0
   ```
   Document each CLI subcommand with usage example. Extract from cli.py argparse definitions.
  </action>
  <verify>Run `sphinx-build -W -b html docs/ docs/_build/html` — API pages render without autodoc errors. Check that `docs/_build/html/api/pipeline.html` shows Pipeline class documentation.</verify>
  <done>API reference covers Pipeline, config models, protocols, calibration, reconstruction functions, and CLI commands with autodoc-generated content</done>
</task>

</tasks>

<verification>
1. README.md has hero image placeholder, 4 badges, quickstart snippet, links to docs
2. `sphinx-build -W -b html docs/ docs/_build/html` passes
3. API pages in `docs/_build/html/api/` render with extracted docstrings
4. Pipeline class, config models, and protocols appear in API docs
5. CLI commands documented with usage examples
</verification>

<success_criteria>
- README is visual-first and informative for new users
- API reference documents all public symbols and extension points
- Internal stage modules are NOT documented (per user decision)
- Sphinx build passes with API autodoc pages
</success_criteria>

<output>
After completion, create `.planning/phases/04-documentation-and-examples/04-02-SUMMARY.md`
</output>
